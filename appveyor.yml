# Using RamblingCookieMonster's Invoke-Parallel examples:
# https://ramblingcookiemonster.github.io/GitHub-Pester-AppVeyor/
# https://github.com/RamblingCookieMonster/Invoke-Parallel/blob/master/appveyor.yml
skip_commits:
  message: "(Add(ed)?|Update(d)?) readme"

install:
  - cinst pester -y

build: false

test_script:
  # pwsh doesn't seem automatically pick up the cinst module (presumably) as it installs in C:\Program Files\WindowsPowershell\Modules
  pwsh: Get-ChildItem -Path "C:\Program Files\WindowsPowerShell\Modules\Pester\" -Recurse -File | Where-Object Name -match "Pester.psd1" |  Select-Object -ExpandProperty FullName | Sort-Object -Descending | Select-Object -First 1  | Import-Module
  pwsh: $Results = Invoke-Pester -Path ".\Tests\" -OutputFormat NUnitXml -OutputFile TestResults.xml -PassThru